(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2073e1"],{a062:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{attrs:{type:"flex",justify:"space-between"}},[s("el-col",{attrs:{span:4}},[s("el-button",{staticStyle:{"margin-top":"20px","margin-bottom":"10px","margin-left":"5px"},attrs:{type:"primary",plain:""},on:{click:function(t){return e.addUser("add")}}},[e._v("添加用户")]),s("el-button",{attrs:{type:"danger",plain:""},on:{click:e.deleteList}},[e._v("批量删除")])],1),s("el-col",{staticStyle:{"margin-top":"20px"},attrs:{span:19}},[s("el-form",{ref:"searchForm",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchUser}},[s("el-form-item",[s("el-input",{attrs:{placeholder:"用户名"},model:{value:e.searchUser.userName,callback:function(t){e.$set(e.searchUser,"userName",t)},expression:"searchUser.userName"}})],1),s("el-form-item",[s("el-input",{attrs:{placeholder:"用户联系电话"},model:{value:e.searchUser.userTel,callback:function(t){e.$set(e.searchUser,"userTel",t)},expression:"searchUser.userTel"}})],1),s("el-form-item",[s("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.searchUser.start,callback:function(t){e.$set(e.searchUser,"start",t)},expression:"searchUser.start"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit("searchForm")}}},[e._v("查询")]),s("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")])],1)],1)],1)],1),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"40"}}),s("el-table-column",{attrs:{type:"index",label:"序号",width:"60",index:e.indexMethod}}),s("el-table-column",{attrs:{prop:"userName",label:"用户名称",width:"80"}}),s("el-table-column",{attrs:{prop:"userTel",label:"用户电话",width:"180"}}),s("el-table-column",{attrs:{prop:"userEmail",label:"用户邮箱",width:"180"}}),s("el-table-column",{attrs:{prop:"userNick",label:"用户昵称",width:"180"}}),s("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"150"}}),s("el-table-column",{attrs:{prop:"updateTime",label:"更新时间",width:"150"}}),s("el-table-column",{attrs:{formatter:e.formatIsDelete,label:"是否有效"}}),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"danger",plain:""},on:{click:function(s){return e.deleteUser(t.row)}}},[e._v("删除")]),s("el-button",{attrs:{type:"primary",plain:""},on:{click:function(s){return e.updateUser(t.row)}}},[e._v("编辑")])]}}])})],1),s("div",[s("el-pagination",{attrs:{"page-count":e.pageCount,"current-page":e.pageNo,background:"",layout:"prev, pager, next"},on:{"prev-click":e.pre,"next-click":e.next,"current-change":e.handleCurrentChange}})],1),s("div",[s("el-dialog",{attrs:{title:"添加用户",visible:e.dialogVisible,width:"30%",center:!0,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-form",{ref:"userForm",staticClass:"demo-ruleForm",attrs:{model:e.userDto,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"用户姓名",prop:"userName"}},[s("el-input",{model:{value:e.userDto.userName,callback:function(t){e.$set(e.userDto,"userName",t)},expression:"userDto.userName"}})],1),s("el-form-item",{attrs:{label:"用户邮箱",prop:"userEmail"}},[s("el-input",{model:{value:e.userDto.userEmail,callback:function(t){e.$set(e.userDto,"userEmail",t)},expression:"userDto.userEmail"}})],1),s("el-form-item",{attrs:{label:"用户电话",prop:"userTel"}},[s("el-input",{model:{value:e.userDto.userTel,callback:function(t){e.$set(e.userDto,"userTel",t)},expression:"userDto.userTel"}})],1),s("el-form-item",{attrs:{label:"用户昵称",prop:"userNick"}},[s("el-input",{model:{value:e.userDto.userNick,callback:function(t){e.$set(e.userDto,"userNick",t)},expression:"userDto.userNick"}})],1),s("el-form-item",{attrs:{label:"用户密码",prop:"password"}},[s("el-input",{attrs:{"show-password":""},model:{value:e.userDto.password,callback:function(t){e.$set(e.userDto,"password",t)},expression:"userDto.password"}})],1),s("el-form-item",{attrs:{label:"角色",prop:"role"}},[s("el-select",{attrs:{multiple:"",placeholder:"请选择用户角色"},model:{value:e.userDto.roleIdList,callback:function(t){e.$set(e.userDto,"roleIdList",t)},expression:"userDto.roleIdList"}},e._l(e.roleList,(function(t,a){return s("el-option",{key:a,attrs:{value:t.roleId,label:t.roleName}},[e._v(e._s(t.roleName))])})),1)],1),s("el-form-item",{attrs:{label:"用户部门",prop:"dept"}},[s("treeselect",{attrs:{"no-options-text":e.msg,flat:!0,multiple:!0,options:e.deptList,normalizer:e.normalizer,placeholder:"请选择部门"},model:{value:e.userDto.deptIdList,callback:function(t){e.$set(e.userDto,"deptIdList",t)},expression:"userDto.deptIdList"}})],1),s("el-form-item",{attrs:{label:"是否有效",prop:"isDelete"}},[s("el-radio-group",{model:{value:e.userDto.isDelete,callback:function(t){e.$set(e.userDto,"isDelete",t)},expression:"userDto.isDelete"}},[s("el-radio",{attrs:{label:"0"}},[e._v("无效")]),s("el-radio",{attrs:{label:"1"}},[e._v("有效")])],1)],1),s("el-form-item",{attrs:{label:"创建日期",prop:"createTime"}},[s("div",{staticClass:"block"},[s("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.userDto.createTime,callback:function(t){e.$set(e.userDto,"createTime",t)},expression:"userDto.createTime"}})],1)]),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("userForm")}}},[e._v("提交")])],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1)],1)],1)},r=[],o=(s("d3b7"),s("25f0"),s("e9c4"),s("bc3a")),l=s.n(o),i=s("ca17"),n=s.n(i),u=(s("542c"),s("0f9a")),c={name:"UserList",computed:{user:function(){return u["default"]}},components:{Treeselect:n.a},data:function(){return{defaultProps:{children:"subDepartmentList",label:"deptName"},msg:null,tableData:[],pageNo:1,pageSize:5,pageCount:0,dialogVisible:!1,userIdList:[],methodName:"",roleList:[],deptList:[],searchUser:{userName:"",userTel:"",start:"",end:""},userDto:{userId:"",deptIdList:[],userName:"",userEmail:"",userTel:"",userNick:"",password:"",createTime:"",isDelete:"1",roleIdList:[]}}},created:function(){this.getPage(this.pageNo,this.pageSize),this.getRoleList(),this.getDeptList()},methods:{resetForm:function(e){this.searchUser.userName="",this.searchUser.userTel="",this.searchUser.start="",this.searchUser.end=""},submit:function(e){var t=this;this.searchUser.end=this.searchUser.start[1],this.searchUser.start=this.searchUser.start[0],this.$refs[e].validate((function(e){if(e){var s=t;l.a.get("http://localhost:8080/userList",{params:{pageNo:s.pageNo,pageSize:s.pageSize,userName:s.searchUser.userName,userTel:s.searchUser.userTel,start:s.searchUser.start,end:s.searchUser.end}}).then((function(e){s.tableData=e.data.data.data,s.pageCount=e.data.data.pageCount,s.searchUser.userName="",s.searchUser.userTel="",s.searchUser.start="",s.searchUser.end=""}))}}))},updateUser:function(e){this.isUpdate=!0,this.methodName="update",this.dialogVisible=!0,this.userDto.userId=e.userId,this.userDto.userEmail=e.userEmail,this.userDto.userTel=e.userTel,this.userDto.userNick=e.userNick,this.userDto.password=e.password,this.userDto.createTime=e.createTime,this.userDto.isDelete=e.isDelete.toString(),this.userDto.userName=e.userName,this.userDto.roleIdList=e.roleIdList,this.userDto.deptIdList=e.deptIdList},normalizer:function(e){return{id:e.deptId,label:e.deptName,children:0===e.subDepartmentList.length?"":e.subDepartmentList}},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;"add"===t.methodName?l.a.post("http://localhost:8080/userAdd",JSON.stringify(t.userDto),{headers:{"Content-Type":"application/json"}}).then((function(e){0===e.data.code?(t.getPage(t.pageNo,t.pageSize),t.$message({message:"添加成功",type:"success"})):-1===e.data.code&&t.$message({message:"添加失败",type:"error"})})):"update"===t.methodName&&l.a.post("http://localhost:8080/userUpdate",JSON.stringify(t.userDto),{headers:{"Content-Type":"application/json"}}).then((function(e){t.isUpdate=!1,0===e.data.code&&(t.getPage(t.pageNo,t.pageSize),t.$message({message:"更新成功",type:"success"}))})),t.dialogVisible=!1,t.userDto.userId="",t.userDto.userEmail="",t.userDto.userTel="",t.userDto.userNick="",t.userDto.password="",t.userDto.createTime="",t.userDto.isDelete="1",t.userDto.userName=""}))},addUser:function(){this.dialogVisible=!0,this.methodName="add"},handleClose:function(){this.dialogVisible=!1},deleteUser:function(e){this.userIdList[0]=e,this.deleteList()},deleteList:function(){var e=this;0===this.userIdList.length?this.$message({message:"请选择用户信息",type:"error"}):this.$confirm("将删除用户信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var t=[],s=e,a=0;a<e.userIdList.length;a++)t.push(e.userIdList[a].userId);e.userIdList=[],l.a.post("http://localhost:8080/userDelete",JSON.stringify(t),{headers:{"Content-Type":"application/json"}}).then((function(e){s.getPage(s.pageNo,s.pageSize),0===e.data.code&&s.$message({message:"删除成功",type:"success"})}))})).catch((function(){e.userIdList=[],e.$message({type:"info",message:"已取消删除"})}))},handleSelectionChange:function(e){this.userIdList=e},formatIsDelete:function(e){return 0===e.isDelete?"无效":"有效"},indexMethod:function(e){return e+1},handleCurrentChange:function(e){this.pageNo=e,this.getPage(e,this.pageSize)},pre:function(){this.getPage(this.pageNo-1,this.pageSize),this.pageNo=this.pageNo-1},next:function(){this.getPage(this.pageNo+1,this.pageSize),this.pageNo=this.pageNo+1},getPage:function(e,t){var s=this;l.a.get("http://localhost:8080/userList",{params:{pageNo:e,pageSize:t}}).then((function(e){s.tableData=e.data.data.data,s.pageCount=e.data.data.pageCount}))},getRoleList:function(){var e=this;l.a.get("http://localhost:8080/roleAll",{}).then((function(t){e.roleList=t.data.data}))},getDeptList:function(){var e=this;l.a.get("http://localhost:8080/deptAll",{}).then((function(t){e.deptList=t.data.data}))}}},p=c,d=s("2877"),m=Object(d["a"])(p,a,r,!1,null,"3a87a7b5",null);t["default"]=m.exports}}]);